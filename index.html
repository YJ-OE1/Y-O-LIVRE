<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
<title>Youssef & Oumaima</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600&family=Great+Vibes&family=IM+Fell+English:ital@0;1&family=Montserrat:wght@300;400&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent;}
:root{
  --gold:#c8a84b;
  --paper:#f2e6c9;
  --paper2:#e8d9b0;
  --ink:#18100a;
  --ink2:#3d2a14;
}
html,body{
  width:100%;height:100%;overflow:hidden;
  background:#080402;
  font-family:'IM Fell English',serif;
}
#app{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;}
#stage{width:100%;height:100%;max-width:430px;position:relative;overflow:hidden;}

/* â•â•â• CANVAS OVERLAYS â•â•â• */
#smokeCanvas{position:absolute;inset:0;z-index:60;pointer-events:none;}
#soulsCanvas{position:fixed;inset:0;z-index:999;pointer-events:none;}

/* â•â•â• COVER â•â•â• */
#cover{
  position:absolute;inset:0;z-index:50;cursor:pointer;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  background:
    radial-gradient(ellipse at 30% 20%, rgba(120,70,20,0.18) 0%, transparent 50%),
    radial-gradient(ellipse at 70% 80%, rgba(80,30,5,0.25) 0%, transparent 45%),
    linear-gradient(170deg,
      #1a0c04 0%,
      #2c1508 8%,
      #3a1c0a 18%,
      #2e1609 30%,
      #3d1f0c 44%,
      #281408 58%,
      #341a0b 72%,
      #1e0f06 85%,
      #170b04 100%);
}
#cover::before{
  content:'';position:absolute;inset:0;pointer-events:none;z-index:1;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='6' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3C/filter%3E%3Crect width='220' height='220' filter='url(%23n)' opacity='0.38'/%3E%3C/svg%3E");
  background-size:220px;mix-blend-mode:overlay;opacity:0.7;
}
#cover::after{
  content:'';position:absolute;inset:0;pointer-events:none;z-index:2;
  background:
    radial-gradient(ellipse at 15% 15%, rgba(255,180,60,0.06) 0%, transparent 35%),
    radial-gradient(ellipse at 85% 85%, rgba(255,160,40,0.05) 0%, transparent 30%),
    radial-gradient(ellipse at 50% 50%, transparent 40%, rgba(0,0,0,0.35) 100%),
    repeating-linear-gradient(87deg, transparent, transparent 18px, rgba(0,0,0,0.012) 18px, rgba(0,0,0,0.012) 19px),
    repeating-linear-gradient(3deg, transparent, transparent 22px, rgba(255,200,80,0.008) 22px, rgba(255,200,80,0.008) 23px);
}

.cv-spine{
  position:absolute;left:0;top:0;bottom:0;width:26px;z-index:5;pointer-events:none;
  background:linear-gradient(90deg,
    rgba(0,0,0,0.7) 0%,
    rgba(80,35,8,0.5) 40%,
    rgba(60,25,5,0.2) 70%,
    transparent 100%);
}
.cv-spine::after{
  content:'';position:absolute;left:18px;top:0;bottom:0;width:1px;
  background:repeating-linear-gradient(to bottom,
    rgba(200,168,75,0.25) 0px, rgba(200,168,75,0.25) 5px,
    transparent 5px, transparent 10px);
}

.cv-frame{
  position:absolute;inset:12px;z-index:5;pointer-events:none;
  border:1.5px solid rgba(200,168,75,0.35);
  box-shadow:
    inset 0 0 30px rgba(0,0,0,0.5),
    0 0 0 1px rgba(0,0,0,0.4);
}
.cv-frame::before{
  content:'';position:absolute;inset:6px;
  border:0.5px solid rgba(200,168,75,0.15);
}
.cv-frame::after{
  content:'';position:absolute;inset:14px;
  border:0.5px solid rgba(200,168,75,0.08);
}

.cv-c{position:absolute;width:38px;height:38px;pointer-events:none;z-index:6;}
.cv-c svg{width:100%;height:100%;}
.cv-c.tl{top:12px;left:12px;}
.cv-c.tr{top:12px;right:12px;transform:scaleX(-1);}
.cv-c.bl{bottom:12px;left:12px;transform:scaleY(-1);}
.cv-c.br{bottom:12px;right:12px;transform:scale(-1);}

.cv-body{
  position:relative;z-index:6;
  display:flex;flex-direction:column;align-items:center;
  padding:20px 28px;text-align:center;width:100%;
}

.cv-label{
  font-family:'Cinzel',serif;
  font-size:clamp(0.44rem,1.9vw,0.56rem);
  letter-spacing:5px;text-transform:uppercase;
  color:rgba(200,168,75,0.55);
  margin-bottom:16px;
  text-shadow:0 1px 3px rgba(0,0,0,0.8),0 0 12px rgba(200,168,75,0.15);
}

.cv-names{
  font-family:'Great Vibes',cursive;
  font-size:clamp(3.6rem,15vw,5.6rem);
  color:#d4a843;
  line-height:1.05;
  text-shadow:
    0 2px 4px rgba(0,0,0,0.9),
    0 0 20px rgba(200,168,75,0.22),
    1px 1px 0 rgba(0,0,0,0.6),
    0 4px 16px rgba(0,0,0,0.7);
  filter:none;
  opacity:1;
}
.cv-amp{
  display:block;
  font-size:0.42em;
  color:rgba(200,168,75,0.65);
  margin:0px 0;
  text-shadow:0 1px 4px rgba(0,0,0,0.8);
}

.cv-div{
  width:140px;height:14px;
  margin:12px auto 10px;
  position:relative;
  flex-shrink:0;
}

.cv-date{
  font-family:'Cinzel',serif;
  font-size:clamp(0.55rem,2.4vw,0.72rem);
  letter-spacing:5px;
  color:rgba(200,168,75,0.72);
  text-transform:uppercase;
  text-shadow:0 1px 4px rgba(0,0,0,0.9),0 0 10px rgba(200,168,75,0.12);
}

.cv-seal{margin-top:20px;opacity:0.9;}

#hint-box{
  position:absolute;bottom:14px;width:100%;text-align:center;pointer-events:none;z-index:7;
}
#hint-text{
  font-family:'Cinzel',serif;
  font-size:clamp(0.55rem,2.5vw,0.7rem);
  letter-spacing:4px;text-transform:uppercase;
  color:rgba(200,168,75,0.65);
  display:inline-block;
  animation:breathe 2.4s ease-in-out infinite;
  text-shadow:0 1px 4px rgba(0,0,0,0.9);
}
@keyframes breathe{0%,100%{opacity:0.3;transform:scale(1)}50%{opacity:1;transform:scale(1.04)}}
#hint-icon{
  display:block;margin:0 auto 6px;
  font-size:1.4rem;
  animation:breathe2 2.4s ease-in-out infinite;
}
@keyframes breathe2{0%,100%{opacity:0.35;transform:scale(0.9)}50%{opacity:0.85;transform:scale(1.1)}}


#dustCanvas{
  position:absolute;inset:0;z-index:55;pointer-events:none;
}

#bookContainer{
  position:absolute;inset:0;
  display:none;
  overflow:hidden;
  perspective:900px;
  perspective-origin:left center;
}

.page{
  position:absolute;inset:0;
  transform-style:preserve-3d;
  transform-origin:left center;
  transition:transform 1s cubic-bezier(0.645,0.045,0.355,1);
  pointer-events:auto;
}
.page.flipped{
  transform:rotateY(-172deg);
  pointer-events:none;
}
.pf{ backface-visibility:hidden; -webkit-backface-visibility:hidden; }
.pb{ backface-visibility:hidden; -webkit-backface-visibility:hidden; transform:rotateY(180deg); }

.pf,.pb{
  position:absolute;inset:0;
  overflow:hidden;
}

/* Base parchment */
.pf{
  background:
    radial-gradient(ellipse at 18% 22%, #ede0c0 0%, transparent 55%),
    radial-gradient(ellipse at 80% 75%, #e4d5a8 0%, transparent 50%),
    radial-gradient(ellipse at 55% 10%, #f0e5c8 0%, transparent 40%),
    linear-gradient(160deg, #f2e6c9 0%, #e8d9b0 40%, #ecdcb4 70%, #e5d4a6 100%);
}
.pb{
  background:
    radial-gradient(ellipse at 22% 78%, #e0d09e 0%, transparent 50%),
    radial-gradient(ellipse at 75% 20%, #e9ddb8 0%, transparent 45%),
    linear-gradient(155deg, #eaddb5 0%, #e2d3a2 50%, #e7d8ac 100%);
}

/* Grain de papier ancien */
.pf::before,.pb::before{
  content:'';position:absolute;inset:0;pointer-events:none;z-index:1;
  background-image:
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='180' height='180'%3E%3Cfilter id='g'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.72' numOctaves='5' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0.15'/%3E%3C/filter%3E%3Crect width='180' height='180' filter='url(%23g)' opacity='0.28'/%3E%3C/svg%3E");
  background-size: 180px;
  mix-blend-mode: multiply;
  opacity: 0.85;
}

/* Bords brunis */
.pf::after,.pb::after{
  content:'';position:absolute;inset:0;pointer-events:none;z-index:2;
  background:
    linear-gradient(to right, rgba(100,70,20,0.18) 0%, rgba(100,70,20,0.06) 3%, transparent 9%),
    linear-gradient(to left,  rgba(80,55,15,0.10) 0%, transparent 6%),
    linear-gradient(to bottom,rgba(80,55,15,0.12) 0%, transparent 5%),
    linear-gradient(to top,   rgba(80,55,15,0.14) 0%, transparent 6%),
    radial-gradient(ellipse at 50% 50%, transparent 35%, rgba(100,70,20,0.07) 100%),
    repeating-linear-gradient(0deg, transparent, transparent 27px, rgba(120,90,30,0.055) 27px, rgba(120,90,30,0.055) 28px),
    radial-gradient(ellipse at 12% 38%, rgba(140,100,30,0.06) 0%, transparent 18%),
    radial-gradient(ellipse at 88% 20%, rgba(120,85,20,0.05) 0%, transparent 14%),
    radial-gradient(ellipse at 65% 82%, rgba(130,95,25,0.07) 0%, transparent 16%),
    radial-gradient(ellipse at 30% 68%, rgba(110,80,20,0.04) 0%, transparent 12%);
}

.pc{
  position:absolute;top:0;left:0;right:0;bottom:52px;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  padding:16px 22px 6px;
  color:var(--ink);z-index:2;overflow:hidden;
}
.pc-chapter{font-family:'Cinzel',serif;font-size:clamp(0.42rem,1.8vw,0.54rem);letter-spacing:5px;text-transform:uppercase;color:var(--gold);opacity:0.65;margin-bottom:3px;}
.pc-title{font-family:'Great Vibes',cursive;font-size:clamp(2rem,9vw,2.8rem);color:var(--ink);line-height:1.15;margin-bottom:2px;text-align:center;}
.pc-rule{display:flex;align-items:center;gap:6px;width:75%;margin:7px auto;}
.pc-rl{flex:1;height:1px;background:linear-gradient(90deg,transparent,rgba(200,168,75,0.32),transparent);}
.pc-rd{color:var(--gold);font-size:6px;opacity:0.5;}
.pc-body{font-family:'IM Fell English',serif;font-style:italic;font-size:clamp(0.88rem,3.8vw,1.05rem);color:var(--ink2);line-height:1.75;text-align:center;margin-top:6px;}
.pc-body.sm{font-size:clamp(0.78rem,3.3vw,0.92rem);}
.pc-body.plain{font-style:normal;}
.pc-folio{font-family:'Cinzel',serif;font-size:0.46rem;letter-spacing:3px;color:var(--ink2);opacity:0.28;margin-top:6px;}

.pg-nav{
  position:absolute;bottom:0;left:0;right:0;height:52px;
  display:flex;align-items:center;justify-content:space-between;
  padding:0 14px;
  background:linear-gradient(to top, rgba(242,230,201,1) 60%, rgba(242,230,201,0) 100%);
  z-index:10;
  border-top:1px solid rgba(200,168,75,0.10);
}
.pb .pg-nav,
.paper2-nav{
  background:linear-gradient(to top, rgba(232,217,176,1) 60%, rgba(232,217,176,0) 100%);
}
.nav-btn{
  background:rgba(200,168,75,0.07);
  border:1px solid rgba(200,168,75,0.22);
  border-radius:50%;width:40px;height:40px;
  font-size:1.15rem;color:var(--gold);
  cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  user-select:none;
  transition:background 0.15s,transform 0.1s;
}
.nav-btn:active{background:rgba(200,168,75,0.2);transform:scale(0.92);}
.nav-btn:disabled{opacity:0.14;cursor:default;background:transparent;border-color:transparent;}
.nav-dots{display:flex;gap:6px;align-items:center;}
.dot{width:5px;height:5px;border-radius:50%;background:rgba(200,168,75,0.18);border:1px solid rgba(200,168,75,0.35);transition:all 0.25s;}
.dot.on{background:var(--gold);transform:scale(1.3);}

.cdown{display:flex;gap:10px;justify-content:center;margin:10px 0 6px;}
.cu{text-align:center;}
.cn{font-family:'Cinzel',serif;font-size:clamp(1.6rem,7vw,2.2rem);font-weight:600;color:var(--ink);line-height:1;display:block;}
.cl{font-family:'Montserrat',sans-serif;font-size:0.42rem;letter-spacing:2px;text-transform:uppercase;color:var(--ink2);opacity:0.55;}
.csep{font-size:1.1rem;color:var(--gold);align-self:center;margin-bottom:4px;opacity:0.4;}
.ring-w{margin:6px 0;filter:drop-shadow(0 3px 10px rgba(200,168,75,0.3));animation:rfloat 3.5s ease-in-out infinite;}
@keyframes rfloat{0%,100%{transform:translateY(0)}50%{transform:translateY(-5px)}}
.vphoto{width:100%;height:clamp(110px,25vw,145px);object-fit:cover;border-radius:1px;box-shadow:0 2px 10px rgba(0,0,0,0.12);margin:6px 0;}

.nh-journey{display:flex;flex-direction:column;align-items:center;width:100%;padding:0 10px 60px;overflow-y:auto;overflow-x:hidden;flex:1;}
.nh-stop{display:flex;align-items:center;gap:8px;width:100%;animation:nhfade 0.8s ease both;}
.nh-stop-left{flex-direction:row;}
.nh-stop-right{flex-direction:row-reverse;}
.nh-img-wrap{position:relative;flex-shrink:0;}
.nh-img{width:clamp(88px,22vw,115px);height:clamp(70px,17vw,92px);object-fit:cover;border-radius:3px;box-shadow:0 3px 14px rgba(0,0,0,0.22);border:2px solid rgba(200,168,75,0.35);}
.nh-pin{position:absolute;top:-8px;right:-6px;font-size:0.85rem;filter:drop-shadow(0 1px 2px rgba(0,0,0,0.3));}
.nh-label{display:flex;flex-direction:column;gap:3px;flex:1;}
.nh-stop-right .nh-label{text-align:right;}
.nh-place{font-family:'Cinzel',serif;font-size:clamp(0.38rem,1.5vw,0.47rem);color:#b8985a;letter-spacing:1.5px;text-transform:uppercase;margin-bottom:3px;}
.nh-caption{font-family:'Palatino Linotype','Palatino',Georgia,serif;font-size:clamp(0.48rem,1.9vw,0.58rem);color:var(--ink2);opacity:0.78;font-style:italic;line-height:1.5;}
.nh-path{width:85%;flex-shrink:0;}
.nh-svg{width:100%;height:38px;display:block;}
.nh-heart{font-size:1.3rem;color:var(--gold);opacity:0.8;margin-top:4px;animation:hb 2s ease-in-out infinite;}
@keyframes nhfade{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.mframe{width:100%;height:clamp(110px,25vw,140px);border:none;border-radius:1px;margin:6px 0;}
.btn-dir{display:inline-block;padding:6px 18px;border:1px solid rgba(200,168,75,0.35);color:var(--gold);font-family:'Cinzel',serif;font-size:0.5rem;letter-spacing:3px;text-transform:uppercase;text-decoration:none;cursor:pointer;margin-top:6px;background:transparent;}
.irow{display:flex;align-items:center;gap:7px;font-family:'Montserrat',sans-serif;font-size:clamp(0.58rem,2.5vw,0.68rem);color:var(--ink2);margin:2px 0;}
.ico{color:var(--gold);font-size:0.82rem;}
.prog{width:100%;text-align:left;margin-top:8px;}
.prog-row{display:flex;align-items:flex-start;gap:10px;margin-bottom:9px;padding-bottom:9px;border-bottom:1px solid rgba(200,168,75,0.09);}
.prog-row:last-child{border-bottom:none;margin-bottom:0;padding-bottom:0;}
.prog-t{font-family:'Cinzel',serif;font-size:0.5rem;letter-spacing:1px;color:var(--gold);min-width:34px;padding-top:3px;}
.prog-ev{font-family:'IM Fell English',serif;font-size:clamp(0.85rem,3.5vw,1rem);font-style:italic;color:var(--ink);}
.prog-sub{font-family:'Montserrat',sans-serif;font-size:0.5rem;color:var(--ink2);opacity:0.6;}
@keyframes hb{0%,100%{transform:scale(1)}50%{transform:scale(1.15)}}

/* â•â•â• PAGE 6 â€” plume + coeur â•â•â• */
.pg6-scene{
  position:relative;
  width:clamp(180px,50vw,220px);
  margin:0 auto 6px;
  height:clamp(190px,52vw,240px);
}
.pg6-heart{
  position:absolute;
  bottom:0;left:50%;transform:translateX(-50%);
  width:clamp(150px,42vw,190px);
  mix-blend-mode:multiply;
  opacity:0.88;
  filter:sepia(0.3) contrast(1.05);
  animation:heartPulse 3s ease-in-out infinite;
}
.pg6-quill{
  position:absolute;
  bottom: clamp(150px, 26vw, 120px);
  right: clamp(148px, 0vw, 0px);
  width:clamp(80px,22vw,105px);
  mix-blend-mode:multiply;
  opacity:0.88;
  filter:sepia(0.35) contrast(1.1);
  transform:rotate(30deg);
  animation:quillDraw 4s ease-in-out infinite;
  transform-origin: bottom center;
}
@keyframes quillDraw{
  0%,100%{ transform:rotate(30deg) translate(0,0); }
  50%{     transform:rotate(27deg) translate(1px,-3px); }
}
@keyframes heartPulse{0%,100%{transform:translateX(-50%) scale(1)}50%{transform:translateX(-50%) scale(1.04)}}
@keyframes quillFloat{0%,100%{transform:rotate(-18deg) translateX(18px) translateY(0)}50%{transform:rotate(-16deg) translateX(18px) translateY(-6px)}}
</style>
</head>
<body>

<canvas id="smokeCanvas"></canvas>
<canvas id="dustCanvas"></canvas>
<canvas id="soulsCanvas"></canvas>

<div id="app">
<div id="stage">

<!-- COVER -->
<div id="cover">
  <div class="cv-spine"></div>
  <div class="cv-frame"></div>

  <div class="cv-c tl"><svg viewBox="0 0 40 40">
    <path d="M2 2 L32 2 L2 32 Z" fill="none" stroke="rgba(200,168,75,0.5)" stroke-width="0.8"/>
    <path d="M2 2 L22 2 L2 22 Z" fill="rgba(200,168,75,0.06)" stroke="rgba(200,168,75,0.3)" stroke-width="0.5"/>
    <line x1="2" y1="2" x2="2" y2="36" stroke="rgba(200,168,75,0.35)" stroke-width="0.7"/>
    <line x1="2" y1="2" x2="36" y2="2" stroke="rgba(200,168,75,0.35)" stroke-width="0.7"/>
    <circle cx="2" cy="2" r="1.8" fill="rgba(200,168,75,0.5)"/>
    <circle cx="14" cy="2" r="1" fill="rgba(200,168,75,0.2)"/>
    <circle cx="2" cy="14" r="1" fill="rgba(200,168,75,0.2)"/>
    <path d="M8 2 Q12 6 8 10 Q4 6 8 2Z" fill="rgba(200,168,75,0.12)" stroke="rgba(200,168,75,0.22)" stroke-width="0.4"/>
  </svg></div>
  <div class="cv-c tr"><svg viewBox="0 0 40 40" style="transform:scaleX(-1)">
    <path d="M2 2 L32 2 L2 32 Z" fill="none" stroke="rgba(200,168,75,0.5)" stroke-width="0.8"/>
    <path d="M2 2 L22 2 L2 22 Z" fill="rgba(200,168,75,0.06)" stroke="rgba(200,168,75,0.3)" stroke-width="0.5"/>
    <line x1="2" y1="2" x2="2" y2="36" stroke="rgba(200,168,75,0.35)" stroke-width="0.7"/>
    <line x1="2" y1="2" x2="36" y2="2" stroke="rgba(200,168,75,0.35)" stroke-width="0.7"/>
    <circle cx="2" cy="2" r="1.8" fill="rgba(200,168,75,0.5)"/>
    <circle cx="14" cy="2" r="1" fill="rgba(200,168,75,0.2)"/>
    <circle cx="2" cy="14" r="1" fill="rgba(200,168,75,0.2)"/>
    <path d="M8 2 Q12 6 8 10 Q4 6 8 2Z" fill="rgba(200,168,75,0.12)" stroke="rgba(200,168,75,0.22)" stroke-width="0.4"/>
  </svg></div>
  <div class="cv-c bl"><svg viewBox="0 0 40 40" style="transform:scaleY(-1)">
    <path d="M2 2 L32 2 L2 32 Z" fill="none" stroke="rgba(200,168,75,0.5)" stroke-width="0.8"/>
    <path d="M2 2 L22 2 L2 22 Z" fill="rgba(200,168,75,0.06)" stroke="rgba(200,168,75,0.3)" stroke-width="0.5"/>
    <line x1="2" y1="2" x2="2" y2="36" stroke="rgba(200,168,75,0.35)" stroke-width="0.7"/>
    <line x1="2" y1="2" x2="36" y2="2" stroke="rgba(200,168,75,0.35)" stroke-width="0.7"/>
    <circle cx="2" cy="2" r="1.8" fill="rgba(200,168,75,0.5)"/>
    <circle cx="14" cy="2" r="1" fill="rgba(200,168,75,0.2)"/>
    <circle cx="2" cy="14" r="1" fill="rgba(200,168,75,0.2)"/>
    <path d="M8 2 Q12 6 8 10 Q4 6 8 2Z" fill="rgba(200,168,75,0.12)" stroke="rgba(200,168,75,0.22)" stroke-width="0.4"/>
  </svg></div>
  <div class="cv-c br"><svg viewBox="0 0 40 40" style="transform:scale(-1)">
    <path d="M2 2 L32 2 L2 32 Z" fill="none" stroke="rgba(200,168,75,0.5)" stroke-width="0.8"/>
    <path d="M2 2 L22 2 L2 22 Z" fill="rgba(200,168,75,0.06)" stroke="rgba(200,168,75,0.3)" stroke-width="0.5"/>
    <line x1="2" y1="2" x2="2" y2="36" stroke="rgba(200,168,75,0.35)" stroke-width="0.7"/>
    <line x1="2" y1="2" x2="36" y2="2" stroke="rgba(200,168,75,0.35)" stroke-width="0.7"/>
    <circle cx="2" cy="2" r="1.8" fill="rgba(200,168,75,0.5)"/>
    <circle cx="14" cy="2" r="1" fill="rgba(200,168,75,0.2)"/>
    <circle cx="2" cy="14" r="1" fill="rgba(200,168,75,0.2)"/>
    <path d="M8 2 Q12 6 8 10 Q4 6 8 2Z" fill="rgba(200,168,75,0.12)" stroke="rgba(200,168,75,0.22)" stroke-width="0.4"/>
  </svg></div>

  <div class="cv-body">

    <svg width="88%" height="18" viewBox="0 0 260 18" style="margin-bottom:10px;flex-shrink:0;">
      <line x1="0" y1="9" x2="90" y2="9" stroke="rgba(200,168,75,0.4)" stroke-width="0.6"/>
      <path d="M95 9 L100 4 L105 9 L100 14 Z" fill="rgba(200,168,75,0.35)" stroke="rgba(200,168,75,0.5)" stroke-width="0.5"/>
      <path d="M110 9 L113 5.5 L116 9 L113 12.5 Z" fill="none" stroke="rgba(200,168,75,0.3)" stroke-width="0.5"/>
      <circle cx="130" cy="9" r="3.5" fill="none" stroke="rgba(200,168,75,0.45)" stroke-width="0.7"/>
      <circle cx="130" cy="9" r="1.2" fill="rgba(200,168,75,0.5)"/>
      <path d="M144 9 L147 5.5 L150 9 L147 12.5 Z" fill="none" stroke="rgba(200,168,75,0.3)" stroke-width="0.5"/>
      <path d="M155 9 L160 4 L165 9 L160 14 Z" fill="rgba(200,168,75,0.35)" stroke="rgba(200,168,75,0.5)" stroke-width="0.5"/>
      <line x1="170" y1="9" x2="260" y2="9" stroke="rgba(200,168,75,0.4)" stroke-width="0.6"/>
    </svg>

    <div style="display:flex;gap:10px;justify-content:center;align-items:center;margin-bottom:6px;">
      <div style="text-align:center;">
        <span id="cv-cdj" style="font-family:'Cinzel',serif;font-size:clamp(0.9rem,4vw,1.15rem);font-weight:600;color:#d4a843;display:block;text-shadow:0 2px 8px rgba(0,0,0,0.9),0 0 12px rgba(200,168,75,0.3);">--</span>
        <span style="font-family:'Montserrat',sans-serif;font-size:0.32rem;letter-spacing:2px;text-transform:uppercase;color:rgba(200,168,75,0.45);">Jours</span>
      </div>
      <span style="color:rgba(200,168,75,0.3);font-size:0.8rem;margin-bottom:8px;">Â·</span>
      <div style="text-align:center;">
        <span id="cv-cdh" style="font-family:'Cinzel',serif;font-size:clamp(0.9rem,4vw,1.15rem);font-weight:600;color:#d4a843;display:block;text-shadow:0 2px 8px rgba(0,0,0,0.9),0 0 12px rgba(200,168,75,0.3);">--</span>
        <span style="font-family:'Montserrat',sans-serif;font-size:0.32rem;letter-spacing:2px;text-transform:uppercase;color:rgba(200,168,75,0.45);">H</span>
      </div>
      <span style="color:rgba(200,168,75,0.3);font-size:0.8rem;margin-bottom:8px;">Â·</span>
      <div style="text-align:center;">
        <span id="cv-cdm" style="font-family:'Cinzel',serif;font-size:clamp(0.9rem,4vw,1.15rem);font-weight:600;color:#d4a843;display:block;text-shadow:0 2px 8px rgba(0,0,0,0.9),0 0 12px rgba(200,168,75,0.3);">--</span>
        <span style="font-family:'Montserrat',sans-serif;font-size:0.32rem;letter-spacing:2px;text-transform:uppercase;color:rgba(200,168,75,0.45);">Min</span>
      </div>
      <span style="color:rgba(200,168,75,0.3);font-size:0.8rem;margin-bottom:8px;">Â·</span>
      <div style="text-align:center;">
        <span id="cv-cds" style="font-family:'Cinzel',serif;font-size:clamp(0.9rem,4vw,1.15rem);font-weight:600;color:#d4a843;display:block;text-shadow:0 2px 8px rgba(0,0,0,0.9),0 0 12px rgba(200,168,75,0.3);">--</span>
        <span style="font-family:'Montserrat',sans-serif;font-size:0.32rem;letter-spacing:2px;text-transform:uppercase;color:rgba(200,168,75,0.45);">Sec</span>
      </div>
    </div>
    <div class="cv-label">Invitation au Mariage</div>



    <div class="cv-names">Youssef<span class="cv-amp">&amp;</span>Oumaima</div>

    <div class="cv-div">
      <svg width="100%" height="14" viewBox="0 0 140 14">
        <line x1="0" y1="7" x2="50" y2="7" stroke="rgba(200,168,75,0.45)" stroke-width="0.6"/>
        <path d="M54 7 L58 3 L62 7 L58 11 Z" fill="rgba(200,168,75,0.4)" stroke="rgba(200,168,75,0.55)" stroke-width="0.5"/>
        <path d="M65 7 L68 4 L71 7 L68 10 Z" fill="none" stroke="rgba(200,168,75,0.35)" stroke-width="0.5"/>
        <circle cx="75" cy="7" r="1.8" fill="rgba(200,168,75,0.55)"/>
        <path d="M79 7 L82 4 L85 7 L82 10 Z" fill="none" stroke="rgba(200,168,75,0.35)" stroke-width="0.5"/>
        <path d="M88 7 L92 3 L96 7 L92 11 Z" fill="rgba(200,168,75,0.4)" stroke="rgba(200,168,75,0.55)" stroke-width="0.5"/>
        <line x1="100" y1="7" x2="140" y2="7" stroke="rgba(200,168,75,0.45)" stroke-width="0.6"/>
      </svg>
    </div>

    <div class="cv-date">Samedi Â· 4 Avril Â· 2026</div>

    <div class="cv-seal">
      <svg width="62" height="62" viewBox="0 0 62 62">
        <ellipse cx="31" cy="58" rx="12" ry="4" fill="rgba(90,15,15,0.4)"/>
        <circle cx="31" cy="31" r="26" fill="url(#waxGrad)"/>
        <defs>
          <radialGradient id="waxGrad" cx="38%" cy="35%" r="60%">
            <stop offset="0%" stop-color="#8b2020"/>
            <stop offset="50%" stop-color="#6b1515"/>
            <stop offset="100%" stop-color="#4a0d0d"/>
          </radialGradient>
        </defs>
        <circle cx="31" cy="31" r="23" fill="none" stroke="rgba(200,168,75,0.4)" stroke-width="0.8"/>
        <circle cx="31" cy="31" r="20" fill="none" stroke="rgba(200,168,75,0.2)" stroke-width="0.4"/>
        <text x="31" y="27" text-anchor="middle" font-family="'Great Vibes',cursive" font-size="11" fill="rgba(220,185,80,0.9)" letter-spacing="1">Y</text>
        <text x="31" y="38" text-anchor="middle" font-family="'Great Vibes',cursive" font-size="11" fill="rgba(220,185,80,0.9)" letter-spacing="1">&amp; O</text>
        <ellipse cx="24" cy="22" rx="5" ry="3" fill="rgba(255,255,255,0.06)" transform="rotate(-25,24,22)"/>
      </svg>
    </div>

    <svg width="88%" height="18" viewBox="0 0 260 18" style="margin-top:8px;flex-shrink:0;">
      <line x1="0" y1="9" x2="90" y2="9" stroke="rgba(200,168,75,0.4)" stroke-width="0.6"/>
      <path d="M95 9 L100 4 L105 9 L100 14 Z" fill="rgba(200,168,75,0.35)" stroke="rgba(200,168,75,0.5)" stroke-width="0.5"/>
      <path d="M110 9 L113 5.5 L116 9 L113 12.5 Z" fill="none" stroke="rgba(200,168,75,0.3)" stroke-width="0.5"/>
      <circle cx="130" cy="9" r="3.5" fill="none" stroke="rgba(200,168,75,0.45)" stroke-width="0.7"/>
      <circle cx="130" cy="9" r="1.2" fill="rgba(200,168,75,0.5)"/>
      <path d="M144 9 L147 5.5 L150 9 L147 12.5 Z" fill="none" stroke="rgba(200,168,75,0.3)" stroke-width="0.5"/>
      <path d="M155 9 L160 4 L165 9 L160 14 Z" fill="rgba(200,168,75,0.35)" stroke="rgba(200,168,75,0.5)" stroke-width="0.5"/>
      <line x1="170" y1="9" x2="260" y2="9" stroke="rgba(200,168,75,0.4)" stroke-width="0.6"/>
    </svg>

  </div>

  <div id="hint-box">
    <span id="hint-icon">ğŸ–</span>
    <span id="hint-text">Toucher pour ouvrir</span>
  </div>
</div>

<!-- PAGES â€” ordre z-index : pg5 en bas, pg0 en haut de la pile -->
<div id="bookContainer">

  <!-- Page 6 â€” Not The End (z-index le plus bas) -->
  <div class="page" id="pg5" style="z-index:4;">
    <div class="pf" style="background:var(--paper);">
      <div class="pc" style="justify-content:center;gap:0;">

        <div class="pg6-scene">
          <img src="assets/coeur.png" alt="coeur empreinte" class="pg6-heart">
          <img src="assets/plume.png" alt="plume" class="pg6-quill">
        </div>

        <div style="text-align:center;margin-top:4px;">
          <div style="font-family:'Cinzel',serif;font-size:clamp(0.38rem,1.6vw,0.48rem);
                      letter-spacing:6px;color:var(--gold);opacity:0.5;text-transform:uppercase;
                      margin-bottom:4px;">â€” mais plutÃ´t â€”</div>
          <div style="font-family:'Great Vibes',cursive;
                      font-size:clamp(2.8rem,13vw,4.2rem);
                      color:var(--ink);line-height:1;
                      text-shadow:0 2px 8px rgba(0,0,0,0.08);">Not The End</div>
          <p class="pc-body" style="margin-top:8px;">but the beginning of our forever.</p>
          <div style="font-family:'Cinzel',serif;font-size:clamp(0.38rem,1.6vw,0.48rem);
                      letter-spacing:5px;color:var(--gold);opacity:0.45;text-transform:uppercase;
                      margin-top:6px;">le dÃ©but de tout</div>
        </div>

        <div class="pc-rule" style="margin-top:14px;"><div class="pc-rl"></div><div class="pc-rd">â—†</div><div class="pc-rl"></div></div>

        <p class="pc-body sm" style="margin-top:8px;opacity:0.55;font-size:clamp(0.72rem,3vw,0.84rem);">
          Youssef &amp; Oumaima<br>
          <span style="font-family:'Cinzel',serif;font-size:0.46rem;letter-spacing:3px;opacity:0.7;">4 Â· 04 Â· 2026</span>
        </p>

        <div class="pc-folio" style="margin-top:10px;">VI</div>
      </div>
      <div class="pg-nav">
        <button class="nav-btn" id="btn5l">&#8592;</button>
        <div class="nav-dots" id="d5"></div>
        <button class="nav-btn" disabled>&#8594;</button>
      </div>
    </div>
  </div>

  <!-- Page 5 -->
  <div class="page" id="pg4" style="z-index:5;">
    <div class="pf">
      <div class="pc" style="justify-content:center;">
        <div class="pc-chapter">Ã‰pilogue</div>
        <div class="pc-title">Avec Amour</div>
        <div class="pc-rule"><div class="pc-rl"></div><div class="pc-rd">â—†</div><div class="pc-rl"></div></div>
        <p class="pc-body" style="margin-top:8px;">Votre prÃ©sence est le plus beau<br>des cadeaux que vous puissiez<br>nous offrir.</p>
        <div style="margin:16px 0;font-family:'Great Vibes',cursive;font-size:clamp(1.6rem,7vw,2.2rem);color:var(--ink2);text-align:center;">Youssef &amp; Oumaima</div>
        <div class="pc-rule"><div class="pc-rl"></div><div class="pc-rd">â—†</div><div class="pc-rl"></div></div>
        <p class="pc-body sm" style="margin-top:10px;opacity:0.58;">Nous vous attendons avec impatience<br>le 4 Avril 2026.</p>
        <div class="pc-folio" style="margin-top:10px;">V</div>
      </div>
      <div class="pg-nav">
        <button class="nav-btn" id="btn4l">&#8592;</button>
        <div class="nav-dots" id="d4"></div>
        <button class="nav-btn" id="btn4r">&#8594;</button>
      </div>
    </div>
  </div>

  <!-- Page 4 -->
  <div class="page" id="pg3" style="z-index:6;">
    <div class="pf" style="background:var(--paper2);">
      <div class="pc" style="justify-content:center;">
        <div class="pc-chapter">Plus que...</div>
        <div class="pc-title">Le Grand Jour</div>
        <div class="pc-rule"><div class="pc-rl"></div><div class="pc-rd">â—†</div><div class="pc-rl"></div></div>
        <div class="cdown" id="countdown">
          <div class="cu"><span class="cn" id="cdj">--</span><span class="cl">Jours</span></div>
          <div class="csep">Â·</div>
          <div class="cu"><span class="cn" id="cdh">--</span><span class="cl">H</span></div>
          <div class="csep">Â·</div>
          <div class="cu"><span class="cn" id="cdm">--</span><span class="cl">Min</span></div>
          <div class="csep">Â·</div>
          <div class="cu"><span class="cn" id="cds">--</span><span class="cl">Sec</span></div>
        </div>
      <div class="ring-w">
          <img src="assets/alliance.png"alt="alliances" style="width:80px;height:80px;object-fit:contain;mix-blend-mode:screen;filter:invert(1) brightness(1.1);animation:rfloat 3.5s ease-in-out infinite;">
        </div>
        <p class="pc-body sm" style="opacity:0.5;">MenkÃ©s Â· Maroc</p>
        <div class="pc-folio" style="margin-top:6px;">IV</div>
      </div>
      <div class="pg-nav" style="background:linear-gradient(to top,rgba(232,217,176,1) 60%,rgba(232,217,176,0) 100%);">
        <button class="nav-btn" id="btn3l">&#8592;</button>
        <div class="nav-dots" id="d3"></div>
        <button class="nav-btn" id="btn3r">&#8594;</button>
      </div>
    </div>
  </div>

  <!-- Page 3 -->
  <div class="page" id="pg2" style="z-index:7;">
    <div class="pf">
      <div class="pc">
        <div class="pc-chapter">Le Lieu</div>
        <div class="pc-title">Notre Salle</div>
        <div class="pc-rule"><div class="pc-rl"></div><div class="pc-rd">â—†</div><div class="pc-rl"></div></div>
        <img class="vphoto" src="assets/notreSalle.jpeg" alt="Salle"/>
        <div class="irow"><span class="ico">ğŸ“</span>MeknÃ©s, Maroc</div>
        <div class="irow"><span class="ico">ğŸ•–</span>Samedi 4 Avril 2026 Â· 19h00</div>
        <div class="irow"><span class="ico">âœ¨</span>SoirÃ©e de Gala</div>
        <a href="https://maps.app.goo.gl/V8ewxEcuPoiRUozn9" target="_blank" class="btn-dir" style="display:inline-flex;align-items:center;gap:6px;margin-top:10px;">ğŸ“ Voir sur Google Maps â†’</a>
        <div class="pc-folio" style="margin-top:8px;">III</div>
      </div>
      <div class="pg-nav">
        <button class="nav-btn" id="btn2l">&#8592;</button>
        <div class="nav-dots" id="d2"></div>
        <button class="nav-btn" id="btn2r">&#8594;</button>
      </div>
    </div>
  </div>

  <!-- Page 2 -->
  <div class="page" id="pg1" style="z-index:8;">
    <div class="pf">
      <div class="pc" style="justify-content:flex-start;padding:0;overflow:hidden;">

        <div style="text-align:center;padding:14px 16px 2px;width:100%;flex-shrink:0;">
          <div class="pc-chapter">Chapitre II</div>
          <div class="pc-title">Notre Histoire</div>
          <div class="pc-rule"><div class="pc-rl"></div><div class="pc-rd">&#9670;</div><div class="pc-rl"></div></div>
        </div>

        <div class="nh-journey">

          <div class="nh-stop nh-stop-left" style="animation-delay:0.1s">
            <div class="nh-img-wrap">
            <img src="assets/photo1.png" class="nh-img">
            </div>
            <div class="nh-label">
              <span class="nh-place">Il &eacute;tait une fois&hellip;</span>
              <span class="nh-caption">parmi des millions d&rsquo;&eacute;toiles dans le ciel,<br>l&rsquo;univers a choisi de te mettre<br>sur mon chemin.</span>
            </div>
          </div>

          <div class="nh-path">
            <svg class="nh-svg" viewBox="0 0 200 48" preserveAspectRatio="none">
              <path d="M 15 8 Q 100 44 185 8" stroke="#b8985a" stroke-width="2.2"
                stroke-dasharray="6 5" fill="none" stroke-linecap="round"/>
              <text x="100" y="32" text-anchor="middle" font-family="serif"
                font-size="13" fill="#b8985a" opacity="0.75">&#9992;</text>
            </svg>
          </div>

          <div class="nh-stop nh-stop-right" style="animation-delay:0.25s">
            <div class="nh-img-wrap">
              <img src="assets/photo2.png" class="nh-img">
            </div>
            <div class="nh-label">
              <span class="nh-place">Dans le silence de l&rsquo;&acirc;me&hellip;</span>
              <span class="nh-caption">je cherchais quelque chose<br>sans savoir que c&rsquo;&eacute;tait toi<br>que je cherchais.</span>
            </div>
          </div>

          <div class="nh-path">
            <svg class="nh-svg" viewBox="0 0 200 48" preserveAspectRatio="none">
              <path d="M 15 8 Q 100 44 185 8" stroke="#b8985a" stroke-width="2.2"
                stroke-dasharray="6 5" fill="none" stroke-linecap="round"/>
              <text x="100" y="32" text-anchor="middle" font-family="serif"
                font-size="12" fill="#b8985a" opacity="0.75">&#128014;</text>
            </svg>
          </div>

          <div class="nh-stop nh-stop-left" style="animation-delay:0.4s">
            <div class="nh-img-wrap">
              <img src="assets/photo3.png" class="nh-img">
            </div>
            <div class="nh-label">
              <span class="nh-place">Et depuis ce jour-l&agrave;&hellip;</span>
              <span class="nh-caption">chaque aventure a un go&ucirc;t de miracle,<br>chaque regard dit ce que<br>les mots n&rsquo;osent pas.</span>
            </div>
          </div>

          <div class="nh-heart">&#9829;</div>

        </div>

        <div class="pc-folio" style="position:absolute;bottom:52px;left:50%;transform:translateX(-50%);">II</div>
      </div>
      <div class="pg-nav">
        <button class="nav-btn" id="btn1l">&#8592;</button>
        <div class="nav-dots" id="d1"></div>
        <button class="nav-btn" id="btn1r">&#8594;</button>
      </div>
    </div>
  </div>

  <!-- Page 1 â€” toujours visible en premier (z-index le plus haut) -->
  <div class="page" id="pg0" style="z-index:9;">
    <div class="pf">
      <div class="pc" style="justify-content:center;">
        <div class="pc-chapter">Chapitre I</div>
        <svg width="40" height="40" viewBox="0 0 60 60" style="margin:4px 0 8px;"><circle cx="30" cy="30" r="26" stroke="rgba(200,168,75,0.2)" stroke-width="0.6" fill="none"/><path d="M30 4C33 14 42 18 30 30C18 18 27 14 30 4Z" fill="rgba(200,168,75,0.09)" stroke="rgba(200,168,75,0.25)" stroke-width="0.5"/><path d="M56 30C46 33 42 42 30 30C42 18 46 27 56 30Z" fill="rgba(200,168,75,0.09)" stroke="rgba(200,168,75,0.25)" stroke-width="0.5"/><path d="M30 56C27 46 18 42 30 30C42 42 33 46 30 56Z" fill="rgba(200,168,75,0.09)" stroke="rgba(200,168,75,0.25)" stroke-width="0.5"/><path d="M4 30C14 27 18 18 30 30C18 42 14 33 4 30Z" fill="rgba(200,168,75,0.09)" stroke="rgba(200,168,75,0.25)" stroke-width="0.5"/><circle cx="30" cy="30" r="3" fill="rgba(200,168,75,0.35)"/></svg>
        <div class="pc-title" style="font-size:clamp(2.2rem,10vw,3rem);">Youssef<br><span style="font-size:0.55em;color:var(--ink2);">&amp;</span><br>Oumaima</div>
        <div class="pc-rule"><div class="pc-rl"></div><div class="pc-rd">â—†</div><div class="pc-rl"></div></div>
        <p class="pc-body plain sm" style="font-family:'Cinzel',serif;font-size:clamp(0.48rem,2vw,0.6rem);letter-spacing:4px;opacity:0.5;margin-top:2px;">INVITATION AU MARIAGE</p>
        <p class="pc-body sm" style="margin-top:10px;opacity:0.62;">Nous avons l'honneur de vous convier<br>Ã  cÃ©lÃ©brer avec nous le plus beau<br>jour de notre vie.</p>
        <div class="pc-folio" style="margin-top:10px;">I</div>
      </div>
      <div class="pg-nav">
        <button class="nav-btn" id="btn0l">&#8592;</button>
        <div class="nav-dots" id="d0"></div>
        <button class="nav-btn" id="btn0r">&#8594;</button>
      </div>
    </div>
  </div>

</div><!-- /bookContainer -->
</div><!-- /stage -->
</div><!-- /app -->

<script>
document.head.insertAdjacentHTML('beforeend','<style>@keyframes hb{0%,100%{transform:scale(1)}50%{transform:scale(1.15)}}</style>');

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  DUST PARTICLE SYSTEM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const DC = document.getElementById('dustCanvas');
const DX = DC.getContext('2d');
let dustParticles = [];
let dustRAF = null;
let dustSettled = true;
let dustCleared = false;

function resizeDustCanvas(){
  const stage = document.getElementById('stage');
  DC.width = stage.offsetWidth;
  DC.height = stage.offsetHeight;
}
resizeDustCanvas();
window.addEventListener('resize', resizeDustCanvas);
function initDust(){
  dustParticles = [];
  const W = DC.width, H = DC.height;
  for(let i = 0; i < 280; i++){
    dustParticles.push({
      x: Math.random() * W,
      y: Math.random() * H,
      r: 0.6 + Math.random() * 2.2,
      alpha: 0.05 + Math.random() * 0.22,
      settled: true,
      vx: 0, vy: 0,
      life: 1.0,
      decay: 0,
      hue: Math.random() < 0.3 ? 40 : 0,
      sat: Math.random() < 0.3 ? 20 : 0,
    });
  }
}

function drawDust(){
  DX.clearRect(0, 0, DC.width, DC.height);
  let anyAlive = false;

  for(let p of dustParticles){
    if(p.life <= 0) continue;
    anyAlive = true;

    if(!p.settled){
      p.x += p.vx;
      p.y += p.vy;
      p.vx *= 0.97;
      p.vy *= 0.97;
      p.vy -= 0.04;
      p.vx += (Math.random() - 0.5) * 0.15;
      p.r += 0.01;
      p.life -= p.decay;
    }

    const a = p.life * p.alpha;
    if(a <= 0) continue;

    const color = p.hue > 0
      ? `hsla(${p.hue},${p.sat}%,85%,${a})`
      : `rgba(210,190,155,${a})`;

    DX.beginPath();
    DX.arc(p.x, p.y, p.r, 0, Math.PI*2);
    DX.fillStyle = color;
    DX.fill();
  }

  if(anyAlive){
    dustRAF = requestAnimationFrame(drawDust);
  } else {
    DX.clearRect(0, 0, DC.width, DC.height);
    dustParticles = [];
    dustRAF = null;
  }
}

function blowDust(cx, cy){
  if(dustCleared) return;
  dustCleared = true;

  for(let p of dustParticles){
    p.settled = false;
    const dx = p.x - cx;
    const dy = p.y - cy;
    const dist = Math.sqrt(dx*dx + dy*dy) + 0.1;
    const force = (150 / (dist + 80)) + 0.5;
    const ang = Math.atan2(dy, dx) + (Math.random()-0.5)*1.2;
    p.vx = Math.cos(ang) * force * (0.5 + Math.random());
    p.vy = Math.sin(ang) * force * (0.3 + Math.random()) - 0.8;
    p.decay = 0.006 + Math.random() * 0.012;
    p.alpha = p.alpha * 0.85;
  }

  if(!dustRAF) dustRAF = requestAnimationFrame(drawDust);
}

function drawDustVignette(){
  const W = DC.width, H = DC.height;
  const film = DX.createRadialGradient(W/2,H/2,0, W/2,H/2,Math.max(W,H)*0.7);
  film.addColorStop(0,'rgba(180,155,90,0.0)');
  film.addColorStop(1,'rgba(120,100,60,0.08)');
  DX.fillStyle = film;
  DX.fillRect(0,0,W,H);
}

initDust();
(function renderSettledDust(){
  DX.clearRect(0,0,DC.width,DC.height);
  for(let p of dustParticles){
    const a=p.alpha;
    const color=p.hue>0?`hsla(${p.hue},${p.sat}%,85%,${a})`:`rgba(210,190,155,${a})`;
    DX.beginPath();
    DX.arc(p.x, p.y, p.r, 0, Math.PI*2);
    DX.fillStyle=color;
    DX.fill();
  }
  drawDustVignette();
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SMOKE PARTICLE SYSTEM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const SC = document.getElementById('smokeCanvas');
const SX = SC.getContext('2d');
let smokeRAF = null;
let smokeParticles = [];

function resizeSmoke(){
  SC.width = window.innerWidth;
  SC.height = window.innerHeight;
}
resizeSmoke();
window.addEventListener('resize', resizeSmoke);

function spawnSmoke(originX, originY){
  const count = 55;
  for(let i = 0; i < count; i++){
    const angle = -Math.PI/2 + (Math.random()-0.5) * Math.PI * 1.1;
    const speed = 0.6 + Math.random() * 2.8;
    smokeParticles.push({
      x: originX + (Math.random()-0.5)*80,
      y: originY + (Math.random()-0.5)*30,
      vx: Math.cos(angle) * speed,
      vy: Math.sin(angle) * speed - 0.5,
      life: 1.0,
      decay: 0.005 + Math.random()*0.008,
      r: 18 + Math.random()*55,
      hue: Math.random() < 0.35 ? 38 : 0,
      sat: Math.random() < 0.35 ? 30 : 0,
    });
  }
}

function drawSmoke(){
  SX.clearRect(0,0,SC.width,SC.height);
  let alive = false;
  for(let p of smokeParticles){
    if(p.life <= 0) continue;
    alive = true;
    p.x += p.vx;
    p.y += p.vy;
    p.vx *= 0.985;
    p.vy *= 0.985;
    p.vy -= 0.012;
    p.r  += 0.55;
    p.life -= p.decay;
    const a = Math.max(0, p.life * 0.22);
    const color = p.hue > 0
      ? `hsla(${p.hue}, ${p.sat}%, 75%, ${a})`
      : `rgba(200,185,160,${a})`;
    const grad = SX.createRadialGradient(p.x,p.y,0,p.x,p.y,p.r);
    grad.addColorStop(0, color);
    grad.addColorStop(1, 'transparent');
    SX.beginPath();
    SX.arc(p.x, p.y, p.r, 0, Math.PI*2);
    SX.fillStyle = grad;
    SX.fill();
  }
  if(alive) smokeRAF = requestAnimationFrame(drawSmoke);
  else {
    SX.clearRect(0,0,SC.width,SC.height);
    smokeParticles = [];
    smokeRAF = null;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  COUNTDOWN
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function tick(){
  const d = new Date('2026-04-04T19:00:00') - new Date();
  if(d<=0)return;
  const j=String(Math.floor(d/86400000)).padStart(2,'0');
  const h=String(Math.floor(d%86400000/3600000)).padStart(2,'0');
  const m=String(Math.floor(d%3600000/60000)).padStart(2,'0');
  const s=String(Math.floor(d%60000/1000)).padStart(2,'0');
  document.getElementById('cdj').textContent=j;
  document.getElementById('cdh').textContent=h;
  document.getElementById('cdm').textContent=m;
  document.getElementById('cds').textContent=s;
  const cvj=document.getElementById('cv-cdj');if(cvj)cvj.textContent=j;
  const cvh=document.getElementById('cv-cdh');if(cvh)cvh.textContent=h;
  const cvm=document.getElementById('cv-cdm');if(cvm)cvm.textContent=m;
  const cvs=document.getElementById('cv-cds');if(cvs)cvs.textContent=s;
}
tick(); setInterval(tick,1000);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  AUDIO
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let _audioCtx    = null;
let _pageSoundBuf = null;
let _audioLoading = false;
let _audioReady   = false;

async function _initPageSound() {
  if (_audioReady || _audioLoading) return;
  _audioLoading = true;

  try {
    _audioCtx = _audioCtx || new (window.AudioContext || window.webkitAudioContext)();
    await _audioCtx.resume();
    // Safari unlock: play a silent buffer
    const silentBuf = _audioCtx.createBuffer(1, 1, 22050);
    const silentSrc = _audioCtx.createBufferSource();
    silentSrc.buffer = silentBuf;
    silentSrc.connect(_audioCtx.destination);
    silentSrc.start(0);
    const b64 = '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8bmdmQ3MsLtPizZAeg+yv9AqW223SSNkADDVBhQruIDUQg5KEpoxdlTuiQAqaqapaIXpMQOF1ESx5bMXgY9iwRStbpyYv1ezfubFFMXUWox+Pvsw9cr0u6hWy6GW//uSwNuAGB0RS+xjC7qmnen9jGFv6CEpeooWonLFY5S27LZPBQWSoCxpDvLWlUSscPw6kazNhsteVHukdZfLIo669h8XehTrSmC2XtAmGJtvRQ7QOzHIrGLluxV5crWM+3LOOPKnd3xm6D7Z//////////////////+FbrbbZLHEQBNeRoyxZDVQJDRzQAQCjF/ISH8aeOhTIZymwmgI0s5brDCvg5AgCEHToGxPqv11XrhgDZa6oSom01XJfFPZFWuxJIlPFDq2FYz2ohO8ETRulZaokAwpUQQAu82dExNZI9d7Mokxhfpcwua1NrqLEuDhqxIRTSCZqzES8ydCMQFUVTpsNhQVXapTPrZpY7GsHRfqOUGMil13dTVahzvZT8Sh7laf7rLmOWXc6pp1SgR3d3hmffa1oBJrahzNy6bJiFAjIQKgRAEhauEKaLyoyhjk8FBy4sOLPdkeInwlUTGhmXOk37eqxPc3zX5pU7MQgJmOiuGKqBC0NFhJWJ8XxTC1HKvhJFaLaetTRH4DeYDALsO4+TgJKxmIhRyjxQhMIf/7ksDsgBYk8TesYwu616EnNZxhdmzExJ62oNNDOOcvz4uRChbqqxSGUmY7tkY48rfBi2fw2vMXdfPC1uaL2ufr////////////////////////////////////////////////////////////////////////////////////////////////8u2267W2yIgBB0mLVPYSpA4ZHUtghcQxBCReRHocKogMEL8jVJY4CgZbAE0HLhsWXiR37XUzlFNRowjYlCy4MXCEruW6+Tv4qeTSBQnWCGLqIIMUXI6i4kaOUOUbpd0QWpOR6UQQQf47hbVQnCFKE/StLgdp4mmXEOQzBZVpsKAkyJN0ngnJc1K1jFJW0sxy5VsWWPrxqeBpkY7ZYm/OH+GTLZt/Tloxpu2222SIgEAUCUJLKhx0mSwJ/UJqS7eixVBkZk6xENWpb0SL9stCCoJBGZWF1QxkrSufqH0kFZ3xbtVRUWGU3GUNjUZUVd6HmbK7dpRhBI4j9KkuJ0v+3BlT1xV/Z1utPFH8v2pfD8LcN2Yde6adScj/+5LA/4Ac0PFH7GHrspoeJ7WcPXf87ADvw7AL/TVqWWrbvPo58enfiM/NVbeH2alnHC6AwpE1qj6Bu71Pf8//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////4m2u122ttZAFq26Gb+PDExrjiMVkwVDK2piLo5KLK3JpL7HluqvCD7iOAOEmizVsq+0jw4sCoeIpMve14HZFzISe4C6Ys4hpkssI7kuwkBUKSPJCnhDDljQz/R+Vw7imisxkNcozKrlipwsqFKiEWF4q3JqNJPq183MB2JREVgJqe3lguGd4rBs5k0p75K+sMt1utskjZABQXIUQSIcBFJVNSUULIAu1Dk2OPLZbq3MQDQCvo4sNtpSPM/bQnZglutPGYLd73hhq+YnJQB1UvD85IhVqWRJJo8j6qKiUOjQonmsn2Plc/sQRgkbTlOrlU687NYl+uMJnTxaxh8hZGrij//uSwP+AH6zbH6xjC0o9m6R1nD1ovS82gR1OS4Wxif///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////g22yRyRyNAABHM8B5DSMoBVHrJMO4HsMMIwKA6jZuBwHBcQDrKus2Ha46uDoel4cyRAKlhWYUNBoSoJTZeZtJKImETwdhJEqPLliyBqGwZHxEzAzEhL0y+CZFKcVtVda1FGkQQFoiXq7DPvt9tZI2AAP4OeMiPUqQs2MASGdGgW3kRhPlQNFFE6Y1LKzqt6vqZDWNaQ1xa6qtRqnQkueS6Rifgw+TL9Q5ef5LyznJybp0ultu2eFz/8zMd1EbAOSGl+W//////////////////////////////////7ksD/gCR81zes4Yt5o5gj9PYlaf/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8HmqmZmZ//2YAGiywSa1GHBJyCRDRcqtkabIEY4okIjtHJPJilPAsK48uRPL622CthEo1y3KaruJqHyyH/itg+/mGQcm3utXsGScQvjfulHs8QtrPGc5+qdA7ba222SSIABYsOkAUBqipFWXN615sEAPiS4THyScWQZZR8lRuMixGsVMI0FaDktu+qkrz2L4nIeVtyyFYwrdmYz0N1SEaYUabetykf///////////////////////////////////////////////////+5LA/4AmeMMnrLzLYWOY5n2GGW3///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+C3G0kmVQAM4k4BCaheiUqA4gJEXwApYA8hqV0NDlz2aLoXWDCqjXNTUMKCoYUZRpJL5xJtg3mqRWUX4iZ/STb+goo//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////uSwP+AKUTFJawka0EKi6Mw9g0h///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////7ksD/gDGgAS4AAAAgAAAlwAAABP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/+5LA/4AxoAEuAAAAIAAAJcAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVEFHTGl2cmUgcGFnZSBxdWkgdG91cm5lIDEADQAAAB7PRGF2aWQgR3JlY2sAdWkgdG91cm5lIDEADQAAAB7PRGF2aWQgR3JlY2sgLSBTb25zIGVuIGxpZ25lAB7PMjAwMwAwMDMAIEdyZWNrIC0gU29ucyBlbiBsaWduZQAezyU=';
    const binary = atob(b64);
    const bytes = new Uint8Array(binary.length);
    for (let i = 0; i < binary.length; i++) bytes[i] = binary.charCodeAt(i);
    _pageSoundBuf = await _audioCtx.decodeAudioData(bytes.buffer);
    _audioReady = true;
  } catch (e) {
    console.warn('Page-turn sound load failed:', e);
  } finally {
    _audioLoading = false;
  }
}

function playPageTurnSound() {
  if (!_audioReady) {
    if (!_audioLoading) _initPageSound();
    return;
  }
  try {
    if (_audioCtx.state === 'suspended') _audioCtx.resume();
    const src  = _audioCtx.createBufferSource();
    src.buffer = _pageSoundBuf;
    const gain = _audioCtx.createGain();
    gain.gain.value = 0.8;
    src.connect(gain);
    gain.connect(_audioCtx.destination);
    src.start();
  } catch (e) {
    console.warn('Sound play failed:', e);
  }
}

// Safari: audio init moved to user gesture (cover click)

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  BOOK OPEN SEQUENCE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const cover       = document.getElementById('cover');
const bookCont    = document.getElementById('bookContainer');
let bookOpen = false;

function openBook(evtX, evtY){
  if(bookOpen) return;
  bookOpen = true;
  cover.style.pointerEvents = 'none';
  _initPageSound(); // Safari: must call in direct user gesture handler

  const stageR = document.getElementById('stage').getBoundingClientRect();
  const localX = (evtX || (stageR.left + stageR.width/2)) - stageR.left;
  const localY = (evtY || (stageR.top + stageR.height/2)) - stageR.top;
  blowDust(localX, localY);

  const r = cover.getBoundingClientRect();
  const cx = r.left + r.width/2;
  const cy = r.top  + r.height * 0.7;
  spawnSmoke(cx, cy);
  drawSmoke();

  cover.style.transition = 'none';
  let shudder = 0;
  const shudderInt = setInterval(()=>{
    shudder++;
    cover.style.transform = `translateX(${(Math.random()-0.5)*6}px) rotate(${(Math.random()-0.5)*0.8}deg)`;
    if(shudder > 8){
      clearInterval(shudderInt);
      cover.style.transform = '';
      cover.style.transition = 'opacity 0.7s ease, transform 0.7s ease';
      cover.style.opacity = '0';
      cover.style.transform = 'translateY(-12px)';
      setTimeout(()=>{
        cover.style.display = 'none';
        bookCont.style.display = 'block';
        // toutes les pages sont visibles par z-index, aucune n'est flippÃ©e
        pages.forEach(p => p.classList.remove('flipped'));
        cur = 0;
        buildDots();
        setTimeout(()=>{
          DC.style.display='none';
        }, 60);
      }, 700);
    }
  }, 55);
}

cover.addEventListener('click', e=>openBook(e.clientX, e.clientY));

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  PAGE TURNING â€” CSS 3D rotateY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const TOTAL = 6;
let cur = 0;
// pages[0] = pg0 (top, z-index:9) â€¦ pages[5] = pg5 (bottom, z-index:4)
const pages = [
  document.getElementById('pg0'),
  document.getElementById('pg1'),
  document.getElementById('pg2'),
  document.getElementById('pg3'),
  document.getElementById('pg4'),
  document.getElementById('pg5'),
];

function nextPage(e){
  if(e) e.stopPropagation();
  if(cur >= TOTAL - 1) return;
  playPageTurnSound();
  pages[cur].classList.add('flipped');
  cur++;
  refreshDots();
}

function prevPage(e){
  if(e) e.stopPropagation();
  if(cur <= 0) return;
  playPageTurnSound();
  cur--;
  pages[cur].classList.remove('flipped');
  refreshDots();
}

function goToCover(e){
  if(e) e.stopPropagation();
  if(!bookOpen) return;
  playPageTurnSound();
  // unflip all pages
  pages.forEach(p => p.classList.remove('flipped'));
  cur = 0;
  // hide book, show cover
  setTimeout(()=>{
    bookCont.style.display='none';
    cover.style.display='';
    cover.style.opacity='1';
    cover.style.transform='';
    cover.style.pointerEvents='auto';
    DC.style.display='';
    dustCleared=false;
    bookOpen=false;
    initDust();
    (function redrawDust(){
      DX.clearRect(0,0,DC.width,DC.height);
      for(let p of dustParticles){
        const a=p.alpha;
        const color=p.hue>0?`hsla(${p.hue},${p.sat}%,85%,${a})`:`rgba(210,190,155,${a})`;
        DX.beginPath(); DX.arc(p.x,p.y,p.r,0,Math.PI*2);
        DX.fillStyle=color; DX.fill();
      }
      drawDustVignette();
    })();
  }, 1000);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  DOTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildDots(){
  for(let i=0;i<TOTAL;i++){
    const el = document.getElementById('d'+i);
    if(!el) continue;
    el.innerHTML='';
    for(let j=0;j<TOTAL;j++){
      const d = document.createElement('div');
      d.className='dot'+(j===0?' on':'');
      el.appendChild(d);
    }
  }
}
function refreshDots(){
  for(let i=0;i<TOTAL;i++){
    const el=document.getElementById('d'+i);
    if(!el)continue;
    el.querySelectorAll('.dot').forEach((d,j)=>d.classList.toggle('on',j===cur));
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  WIRE BUTTONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function wire(id, fn){
  const el = document.getElementById(id);
  if(el) el.addEventListener('click', fn);
}
wire('btn0l', goToCover); wire('btn0r', nextPage);
wire('btn1l', prevPage);  wire('btn1r', nextPage);
wire('btn2l', prevPage);  wire('btn2r', nextPage);
wire('btn3l', prevPage);  wire('btn3r', nextPage);
wire('btn4l', prevPage);  wire('btn4r', nextPage);
wire('btn5l', prevPage);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  KEYBOARD + SWIPE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.addEventListener('keydown', e=>{
  if(!bookOpen){ openBook(); return; }
  if(e.key==='ArrowRight') nextPage(null);
  if(e.key==='ArrowLeft')  prevPage(null);
});
let tx=0;
document.addEventListener('touchstart',e=>{ tx=e.touches[0].clientX; },{passive:true});
document.addEventListener('touchend',e=>{
  if(!bookOpen) return;
  const dx=e.changedTouches[0].clientX - tx;
  if(Math.abs(dx)<50) return;
  dx<0 ? nextPage(null) : prevPage(null);
},{passive:true});
</script>
</body>
</html>

